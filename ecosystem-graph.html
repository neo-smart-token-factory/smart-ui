<!DOCTYPE html>
<!--
    NE√ò Ecosystem Graph
    Visualiza√ß√£o interativa das conex√µes do ecossistema NE√ò Smart Token Factory
    
    Este arquivo n√£o deve ser indexado por motores de busca (meta robots: noindex).
    Utilizado apenas para visualiza√ß√£o interna da arquitetura do projeto.
    
    Tecnologias: D3.js v7.8.5
    Data: Janeiro 2026
-->
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO: Prevenir indexa√ß√£o -->
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta name="googlebot" content="noindex, nofollow">
    
    <title>NE√ò Ecosystem Graph</title>
    
    <!-- D3.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0E0E0E;
            color: #fff;
            overflow: hidden;
        }

        #graph {
            width: 100vw;
            height: 100vh;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(17, 18, 20, 0.95);
            border: 1px solid #D8F244;
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .controls h2 {
            color: #D8F244;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }

        .controls button {
            background: linear-gradient(135deg, #D8F244, #00E5FF);
            color: #0E0E0E;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin: 5px;
            transition: transform 0.2s;
        }

        .controls button:hover {
            transform: scale(1.05);
        }

        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(17, 18, 20, 0.95);
            border: 1px solid #D8F244;
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 14px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }

        .node {
            cursor: pointer;
            transition: all 0.3s;
        }

        .node:hover {
            filter: brightness(1.3);
        }

        .node-label {
            font-size: 12px;
            font-weight: 600;
            pointer-events: none;
            text-shadow: 0 0 4px #0E0E0E;
        }

        .link {
            stroke-opacity: 0.6;
            transition: stroke-width 0.3s;
        }

        .link:hover {
            stroke-width: 3 !important;
            stroke-opacity: 1;
        }

        .link-label {
            font-size: 10px;
            fill: #D8F244;
            text-anchor: middle;
            pointer-events: none;
        }

        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(17, 18, 20, 0.95);
            border: 1px solid #FF2E9A;
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            max-width: 300px;
            display: none;
        }

        .info-panel.active {
            display: block;
        }

        .info-panel h3 {
            color: #D8F244;
            margin-bottom: 10px;
        }

        .info-panel p {
            font-size: 13px;
            line-height: 1.6;
            margin: 5px 0;
        }

        .legend-title {
            color: #D8F244;
            margin-bottom: 10px;
        }

        .legend-color-core {
            background: #D8F244;
        }

        .legend-color-ui {
            background: #FF2E9A;
        }

        .legend-color-infra {
            background: #00E5FF;
        }

        .legend-color-workflow {
            background: #9333EA;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <div class="controls" role="toolbar" aria-label="Controles do gr√°fico">
        <h2>üéõÔ∏è Controles</h2>
        <button type="button" id="btnReset" aria-label="Resetar visualiza√ß√£o">üîÑ Reset</button>
        <button type="button" id="btnPhysics" aria-label="Alternar f√≠sica da simula√ß√£o">‚ö° F√≠sica: ON</button>
        <button type="button" id="btnCenter" aria-label="Centralizar visualiza√ß√£o">üéØ Centralizar</button>
    </div>

    <div class="legend" role="complementary" aria-label="Legenda do gr√°fico">
        <h3 class="legend-title">Legenda</h3>
        <div class="legend-item">
            <div class="legend-color legend-color-core" aria-hidden="true"></div>
            <span>Reposit√≥rios Core</span>
        </div>
        <div class="legend-item">
            <div class="legend-color legend-color-ui" aria-hidden="true"></div>
            <span>Componentes UI</span>
        </div>
        <div class="legend-item">
            <div class="legend-color legend-color-infra" aria-hidden="true"></div>
            <span>Infraestrutura</span>
        </div>
        <div class="legend-item">
            <div class="legend-color legend-color-workflow" aria-hidden="true"></div>
            <span>Workflows</span>
        </div>
    </div>

    <div class="info-panel" id="infoPanel" role="dialog" aria-labelledby="infoTitle" aria-live="polite" aria-hidden="true">
        <h3 id="infoTitle">Selecione um n√≥</h3>
        <p id="infoDescription"></p>
        <p id="infoConnections"></p>
    </div>

    <svg id="graph" role="img" aria-label="Gr√°fico interativo do ecossistema NE√ò"></svg>

    <script>
        'use strict';

        /**
         * NE√ò Ecosystem Graph
         * Visualiza√ß√£o interativa das conex√µes do ecossistema NE√ò
         * @namespace
         */
        (function() {
            // Verificar se D3.js est√° carregado
            if (typeof d3 === 'undefined') {
                console.error('D3.js n√£o foi carregado. Verifique a conex√£o com a CDN.');
                document.body.innerHTML = '<div style="padding: 20px; color: #fff; text-align: center;"><h1>Erro ao carregar D3.js</h1><p>Por favor, verifique sua conex√£o com a internet.</p></div>';
                return;
            }

            // Aguardar DOM estar pronto
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }

            function init() {
            // Dados do ecossistema NE√ò (p√≥s-migra√ß√£o: 3 reposit√≥rios separados)
            const data = {
            nodes: [
                // Reposit√≥rios
                { id: 'neo-smart-factory', label: 'neo-smart-factory', type: 'repo-core', description: 'Reposit√≥rio principal com contratos, CLI e opera√ß√µes internas' },
                { id: 'smart-ui', label: 'smart-ui', type: 'repo-ui', description: 'Dashboard React com API routes (reposit√≥rio √∫nico)' },
                { id: 'smart-ui-landing', label: 'smart-ui-landing', type: 'repo-ui', description: 'Landing page React + Vite (reposit√≥rio separado)' },
                { id: 'smart-ui-mobile', label: 'smart-ui-mobile', type: 'repo-ui', description: 'App mobile Vue + Vite (reposit√≥rio separado)' },
                { id: 'docs', label: 'docs', type: 'repo-core', description: 'Reposit√≥rio de documenta√ß√£o centralizada' },
                
                // Componentes neo-smart-factory
                { id: 'forge-core', label: 'forge-core', type: 'component', description: 'Contratos Solidity e ABIs' },
                { id: 'forge-cli', label: 'forge-cli', type: 'component', description: 'CLI do ecossistema NE√ò' },
                { id: 'internal-ops', label: 'internal-ops', type: 'component', description: 'Opera√ß√µes internas e estado do ecossistema' },
                { id: 'changelog', label: 'changelog.md', type: 'component', description: 'Changelog centralizado do ecossistema' },
                { id: 'state', label: 'state.json', type: 'component', description: 'Estado operacional (em internal-ops/)' },
                
                // Componentes smart-ui (Dashboard)
                { id: 'dashboard', label: 'Dashboard (src/)', type: 'ui', description: 'Dashboard principal React com API routes' },
                { id: 'api', label: 'API Routes (api/)', type: 'ui', description: 'Vercel Serverless Functions' },
                
                // Workflows
                { id: 'protocol-health', label: 'protocol-health.yml', type: 'workflow', description: 'Health check do ecossistema com checkout cross-repo' },
                { id: 'docs-guard', label: 'docs-guard.yml', type: 'workflow', description: 'Valida√ß√£o de documenta√ß√£o em PRs' },
                { id: 'smart-mint', label: 'smart-mint-protocol', type: 'workflow', description: 'Workflow de sincroniza√ß√£o multi-repo (documentado)' },
                
                // Infraestrutura
                { id: 'vercel', label: 'Vercel', type: 'infra', description: 'Plataforma de deploy (3 projetos separados: dashboard, landing, mobile)' },
                { id: 'neon', label: 'Neon Database', type: 'infra', description: 'PostgreSQL serverless' },
                { id: 'alchemy', label: 'Alchemy', type: 'infra', description: 'RPC Provider para Web3' }
            ],
            links: [
                // Conex√µes cross-repo (GitHub Actions)
                { source: 'protocol-health', target: 'smart-ui', label: 'checkout', type: 'workflow' },
                { source: 'protocol-health', target: 'neo-smart-factory', label: 'checkout', type: 'workflow' },
                { source: 'docs-guard', target: 'smart-ui', label: 'validates', type: 'workflow' },
                
                // Workflow smart-mint (sincroniza√ß√£o)
                { source: 'smart-mint', target: 'forge-core', label: 'sync ABIs', type: 'workflow' },
                { source: 'smart-mint', target: 'changelog', label: 'update', type: 'workflow' },
                { source: 'smart-mint', target: 'state', label: 'update', type: 'workflow' },
                { source: 'smart-ui', target: 'smart-mint', label: 'follows', type: 'workflow' },
                
                // Estrutura neo-smart-factory
                { source: 'neo-smart-factory', target: 'forge-core', label: 'contains', type: 'structure' },
                { source: 'neo-smart-factory', target: 'forge-cli', label: 'contains', type: 'structure' },
                { source: 'neo-smart-factory', target: 'internal-ops', label: 'contains', type: 'structure' },
                { source: 'neo-smart-factory', target: 'changelog', label: 'contains', type: 'structure' },
                { source: 'internal-ops', target: 'state', label: 'contains', type: 'structure' },
                
                // Estrutura smart-ui (Dashboard)
                { source: 'smart-ui', target: 'dashboard', label: 'contains', type: 'structure' },
                { source: 'smart-ui', target: 'api', label: 'contains', type: 'structure' },
                { source: 'dashboard', target: 'api', label: 'uses', type: 'structure' },
                
                // Workflows executados em smart-ui
                { source: 'smart-ui', target: 'protocol-health', label: 'runs', type: 'workflow' },
                { source: 'smart-ui', target: 'docs-guard', label: 'runs', type: 'workflow' },
                
                // Deploy e infraestrutura
                { source: 'smart-ui', target: 'vercel', label: 'deploys to', type: 'deploy' },
                { source: 'smart-ui-landing', target: 'vercel', label: 'deploys to', type: 'deploy' },
                { source: 'smart-ui-mobile', target: 'vercel', label: 'deploys to', type: 'deploy' },
                { source: 'dashboard', target: 'neon', label: 'reads from', type: 'data' },
                { source: 'api', target: 'neon', label: 'queries', type: 'data' },
                { source: 'dashboard', target: 'alchemy', label: 'RPC calls', type: 'data' },
                
                // Documenta√ß√£o
                { source: 'smart-ui', target: 'docs', label: 'references', type: 'docs' },
                { source: 'smart-ui-landing', target: 'docs', label: 'references', type: 'docs' },
                { source: 'smart-ui-mobile', target: 'docs', label: 'references', type: 'docs' },
                { source: 'neo-smart-factory', target: 'docs', label: 'references', type: 'docs' },
                { source: 'docs-guard', target: 'docs', label: 'validates', type: 'docs' }
            ]
        };

            // Configura√ß√£o D3
            const width = window.innerWidth;
            const height = window.innerHeight;

            const svg = d3.select('#graph')
                .attr('width', width)
                .attr('height', height);

            const g = svg.append('g');

            // Zoom
            const zoom = d3.zoom()
                .scaleExtent([0.1, 4])
                .on('zoom', (event) => {
                    g.attr('transform', event.transform);
                });

            svg.call(zoom);

            // Cores por tipo
            const colorMap = {
            'repo-core': '#D8F244',
            'repo-ui': '#FF2E9A',
            'component': '#D8F244',
            'ui': '#FF2E9A',
            'workflow': '#9333EA',
            'infra': '#00E5FF'
        };

            const linkColorMap = {
                'cross-repo': '#D8F244',
                'workflow': '#9333EA',
                'structure': '#666',
                'deploy': '#00E5FF',
                'data': '#FF2E9A',
                'docs': '#D8F244'
            };

            // Simula√ß√£o de for√ßa
            const simulation = d3.forceSimulation(data.nodes)
            .force('link', d3.forceLink(data.links).id(d => d.id).distance(150))
            .force('charge', d3.forceManyBody().strength(-500))
            .force('center', d3.forceCenter(width / 2, height / 2))
            .force('collision', d3.forceCollide().radius(50));

            // Links
            const link = g.append('g')
                .selectAll('line')
                .data(data.links)
                .join('line')
                .attr('class', 'link')
                .attr('stroke', d => linkColorMap[d.type] || '#666')
                .attr('stroke-width', 2);

            // Labels dos links
            const linkLabel = g.append('g')
                .selectAll('text')
                .data(data.links)
                .join('text')
                .attr('class', 'link-label')
                .text(d => d.label);

            // Nodes
            const node = g.append('g')
                .selectAll('g')
                .data(data.nodes)
                .join('g')
                .attr('class', 'node')
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended))
                .on('click', showInfo);

        node.append('circle')
            .attr('r', d => d.type.includes('repo') ? 25 : 15)
            .attr('fill', d => colorMap[d.type])
            .attr('stroke', '#0E0E0E')
            .attr('stroke-width', 3);

        node.append('text')
            .attr('class', 'node-label')
            .attr('dy', d => d.type.includes('repo') ? 35 : 25)
            .attr('text-anchor', 'middle')
            .attr('fill', '#fff')
            .text(d => d.label);

            // Atualiza√ß√£o da simula√ß√£o
            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                linkLabel
                    .attr('x', d => (d.source.x + d.target.x) / 2)
                    .attr('y', d => (d.source.y + d.target.y) / 2);

                node.attr('transform', d => `translate(${d.x},${d.y})`);
            });

            // Fun√ß√µes de drag
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }

            // Estado da f√≠sica
            let physicsEnabled = true;

            // Fun√ß√µes de controle
            function resetSimulation() {
                simulation.alpha(1).restart();
                svg.transition().duration(750).call(
                    zoom.transform,
                    d3.zoomIdentity
                );
            }

            function togglePhysics(event) {
                physicsEnabled = !physicsEnabled;
                const button = event.target;
                if (physicsEnabled) {
                    simulation.alpha(0.3).restart();
                    button.textContent = '‚ö° F√≠sica: ON';
                    button.setAttribute('aria-label', 'Desativar f√≠sica da simula√ß√£o');
                } else {
                    simulation.stop();
                    button.textContent = '‚ö° F√≠sica: OFF';
                    button.setAttribute('aria-label', 'Ativar f√≠sica da simula√ß√£o');
                }
            }

            function centerView() {
                svg.transition().duration(750).call(
                    zoom.transform,
                    d3.zoomIdentity.translate(width / 2, height / 2).scale(1)
                );
            }

            function showInfo(event, d) {
                const panel = document.getElementById('infoPanel');
                const connections = data.links.filter(l => {
                    const sourceId = typeof l.source === 'object' ? l.source.id : l.source;
                    const targetId = typeof l.target === 'object' ? l.target.id : l.target;
                    return sourceId === d.id || targetId === d.id;
                }).length;
                
                document.getElementById('infoTitle').textContent = d.label;
                document.getElementById('infoDescription').textContent = d.description;
                document.getElementById('infoConnections').textContent = `Conex√µes: ${connections}`;
                
                panel.classList.add('active');
                panel.setAttribute('aria-hidden', 'false');
                
                // Highlight
                node.style('opacity', n => n === d ? 1 : 0.3);
                link.style('opacity', l => {
                    const sourceId = typeof l.source === 'object' ? l.source.id : l.source;
                    const targetId = typeof l.target === 'object' ? l.target.id : l.target;
                    return sourceId === d.id || targetId === d.id ? 1 : 0.1;
                });
            }

            // Click fora para desselecionar
            svg.on('click', function(event) {
                if (event.target === this || event.target.tagName === 'line') {
                    const panel = document.getElementById('infoPanel');
                    panel.classList.remove('active');
                    panel.setAttribute('aria-hidden', 'true');
                    node.style('opacity', 1);
                    link.style('opacity', 0.6);
                }
            });

            // Event listeners para bot√µes
            document.getElementById('btnReset').addEventListener('click', resetSimulation);
            document.getElementById('btnPhysics').addEventListener('click', togglePhysics);
            document.getElementById('btnCenter').addEventListener('click', centerView);

                // Inicializa√ß√£o
                resetSimulation();
            }
        })();
    </script>
</body>
</html>
